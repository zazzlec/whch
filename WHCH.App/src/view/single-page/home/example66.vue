<style scoped  lang="less">

.znch{
   
    position: relative;
    background-color: #f0f0f0;
    width: 100%;
    height: 100%;
    display: block;
    overflow: hidden;
    position: relative;
    border: 1px solid #111;
    .btm{
      height: 50%;
      width: 100%;
      border: 1px solid #111;
      float: left;
      overflow: hidden;
      .svgl{
        width: 60%   !important;
      }
      .svg2{
        height: 100%;
        width: 40%;
        border: 1px solid rgb(59, 204, 11);
        float: left;
        overflow: hidden;
        .h{
          height: 10%;
          line-height: 180%;
          font-size: 18px;
          padding-left:3px;
          font-weight: 500;
        }
        .item{
          height: 15%;
          // border: 1px solid #222;
          font-size: 16px;
          line-height: 300%;
          text-align: center;
          .t1{
            height: 100%;
            width: 20%;
            float: left;
            // border: 1px solid #222;
          }
          .t1:hover{
            color: #6da0e4;
            cursor: pointer;
          }
          .t2{
            height: 100%;
            width: 60%;
            float: left;
            // border: 1px solid #222;
            position: relative;
            .tt{
              height: 20%;
              width: 90%;
              margin-left: 5%;
              margin-top: 6%;
              .t{
                background-color: #ebe1c8;
                border-radius: 5px;
                float: left;
                width: 10%;
                height: 100%;
                border: 1.5px dashed #666;
              }
            }
            .lv{
              .t{
                background-color: #00a67c !important;
              }
            }
            .hong{
              .t{
                background-color: #ff6666 !important;
              }
            }
            .k{
              position:absolute;
              top: 0px;
              left: 20%;
              
              width: 10%;
              height: 70%;
              line-height: 120%;
              color: green;
              // border: 1px solid #666;
              .t{
                display: block;
                border-radius: 5px;
                width: 100%;
                height: 60%;
                border: 1px solid green;
                text-align: center;

              }
              .s{
                display: block;
                width: 100%;
                height: 20%;
                .sj{
                  margin: 0px auto;
                  width: 0;
                  height: 0;
                  border-width: 0 6px 6px;
                  border-style: solid;
                  border-color: transparent transparent green;
                  transform: rotateX(180deg);
                }
              }
            }
            
          }
          .t3{
            height: 100%;
            width: 20%;
            float: left;
            // border: 1px solid #222;
            .ii{
              line-height: 150%;
              height: 100%;
              width: 100%;
              // border: 1px solid #222;
              font-size: 13px;
              float: left;
            }
          }
        }


        .you{
          float: left;
          // border: 1px solid #555;
          width: 50%;
          height: 50%;
          font-size: 22px;
          font-weight: 500;
          .t{
            border: 3px solid #6da0e4;
            margin: 0px auto;
            text-align: center;
            border-radius: 50%;
            width: calc(20vh); 
            height: 80%;
            line-height: 600%;
          }
          .b{
            text-align: center;
            color:#6da0e4;
          }
        }

      }
      
    }
    .top{
      height: 50%;
      width: 100%;
      border: 1px solid #111;
      float: left;
      overflow: hidden;
      .svgl{
        width: 60%  !important;
      }
      .svg2{
        height: 100%;
        width: 40%;
        border: 1px solid rgb(59, 204, 11);
        float: left;
        overflow: hidden;
        .btn{
          display: block;
          width: 30%;
          height: 10%;
          border: 1px solid #FF6347;
          border-radius: 10px;
          margin-left: 12%;
          margin-top: 1%;
          text-align: center;
          font-size: 20px;
          background-color: #FFE4E1;
          line-height: 160%;
          float: left;
          cursor: pointer;
        }
        .btn:hover{
          border: 1px solid #030301;
          background-color: #F4A460;
        }


        .btn2{
          display: block;
          width: 25%;
          height: 25%;
          border: 1px solid #DAA520;
          border-radius: 10px;
          margin-left: 6%;
          margin-top: 1%;
          text-align: center;
          font-size: 20px;
          background-color: #FAFAD2;
          line-height: 160%;
          float: left;
          cursor: pointer;
          sub{
            font-size: 13px;
          }
          .n{
            font-size: 28px;
            height: 60%;
            line-height: 220%;
          }
          .l{
            height: 40%;
          }
        }

        .list{
          display: block;
          width: 87%;
          height: 57%;
          border: 1px solid #DAA520;
          border-radius: 7px;
          margin-left: 6%;
          margin-top: 2%;
          font-size: 16px;
          line-height: 160%;
          float: left;
          overflow: hidden;
          .l{
            width:10%;
            height: 100%;
            // border: 1px solid #666;
            float: left;
            display:block;
            position: relative;
            .n{
              position:absolute;
              border-bottom-left-radius: 5px;
              border-top-left-radius: 5px;
              background-color: #eee;
              width: 66%;
              height: 42%;
              line-height: 120%;
              border-top: 1px solid #666;
              border-left: 1px solid #666;
              border-bottom: 1px solid #666;
              text-align: center;
              top: 15%;
              padding: 3%;
              right: 0px;
              cursor:pointer;
              z-index: 888;
              color: #111;
            }
            
            .n:hover{
              font-weight: 800;
            }
            .act1{
              background-color: #fff;
              right: -2px;
            }

            .n2{
              top: 58%;
              height: 33%;
            }
          }
          .q{
            float: left;
              width:90%;
              height: 100%;
              background-color: #fff;
              border-top-left-radius: 10px;
              border-bottom-left-radius: 10px;
              border-top: 2px solid #666;
              border-bottom: 2px solid #666;
              border-left: 2px solid #666;
              color:#000;
              font-size: 13px;
              font-family: '微软雅黑';
              line-height: 18px;
              position: relative;
              .h{
                margin: 0px auto;
                width: 100%;
                height: 30px;
                line-height: 30px;
                border-bottom: 1px solid #ddd;
                text-align: center;
              }
              .waith{
                margin: 0px auto;
                width: 100%;
                height: 30px;
                line-height: 30px;
                border-bottom: 1px solid #ddd;
                text-align: center;
                .t1{
                  height: 30px;
                  line-height: 30px;
                  width: 39%;
                  text-align: center;
                  float: left;
                }
                .t2{
                  height: 30px;
                  line-height: 30px;
                  width: 15%;
                  text-align: center;
                  float: left;
                }
                .t3{
                  height: 30px;
                  line-height: 30px;
                  width: 46%;
                  text-align: center;
                  float: left;
                }
              }
              .wait{
                margin: 0px auto;
                width: 100%;
                height: 100%;
                line-height: 30px;
                overflow-y: scroll;
                text-align: center;
                .t1{
                  height: 30px;
                  line-height: 30px;
                  width: 33%;
                  text-align: center;
                  float: left;
                }
                .t2{
                  height: 30px;
                  line-height: 30px;
                  width: 33%;
                  text-align: center;
                  float: left;
                }
                .t3{
                  height: 30px;
                  line-height: 30px;
                  width: 34%;
                  text-align: center;
                  float: left;
                }
              }

              .runh{
                margin: 0px auto;
                width: 100%;
                height: 30px;
                line-height: 30px;
                border-bottom: 1px solid #ddd;
                text-align: center;
                .t1{
                  height: 30px;
                  line-height: 30px;
                  width: 39%;
                  text-align: center;
                  float: left;
                }
                .t2{
                  height: 30px;
                  line-height: 30px;
                  width: 15%;
                  text-align: center;
                  float: left;
                }
                .t3{
                  height: 30px;
                  line-height: 30px;
                  width: 46%;
                  text-align: center;
                  float: left;
                }
              }
              .run{
                margin: 0px auto;
                width: 100%;
                height: 352px;
                line-height: 30px;
                overflow-y: scroll;
                text-align: center;
                
                .t1{
                  height: 30px;
                  line-height: 30px;
                  width: 33%;
                  text-align: center;
                  float: left;
                }
                .t2{
                  height: 30px;
                  line-height: 30px;
                  width: 33%;
                  text-align: center;
                  float: left;
                }
                .t3{
                  height: 30px;
                  line-height: 30px;
                  width: 34%;
                  text-align: center;
                  float: left;
                }
              }
              .b{
                position:absolute;
                bottom: 1px;
                right: 16px;
                z-index: 999;
              }
            }
        }
      }
      .svg{
        height: 100%;
        background-color: #fff;
        float: left;
        width: 50%;
        position: relative;
        overflow: hidden;
        border: 1px solid rgb(137, 16, 16);
       
        .logo{
          position:absolute;
          top: 10px;
          z-index: 999;

          
          width: 160px;
          text-align: center;
          height: 30px;
          color:#fff;
          .time{
            margin-left:10px;font-size:13px;
          }
          .drop{
            height:30px;line-height:30px;font-size:15px;
          }
          .ivu-dropdown-rel{
            a,a:hover{
              color:#fff ;
            }
          }
          
          img{
            height: 100%;
            vertical-align:middle;
          }
        }
        .allp{
          width: 100%;
          height: 100%;
          position:absolute;
          top: 0px;
          left: 0px;
        }
        .liumian{
          position:absolute;
          top: 20px;
          left: 1px;
          width: 205px;
          height: auto;
          z-index: 999;
        }

        .viewway2{
          position:absolute;
          left:203px;
          top: 6px;
          width: 280px;
          height: 30px;
          line-height: 30px;
          font-size: 16px;
          color:#fff;
          z-index: 899;
          .l{
            float: left;
            width: 138px;
            height: 30px;
            line-height: 30px;
          }
          .r{
            float: left;
            width: 138px;
            height: 30px;
            line-height: 30px;
            margin-top:-2px;
          }
        }
        .viewway{
          position:absolute;
          top: 6px;
          width: 80px;
          height: 30px;
          background-color: #fff;
          z-index: 899;
          border: 1px solid #ddd;
          .t1{
            width: 50%;
            float: left;
            height: 30px;
            line-height: 30px;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
          }
          .t2{
            width: 50%;
            float: left;
            height: 30px;
            line-height: 30px;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
          }
          .c{
            background-color: dodgerblue;
            color:#fff;
            height: 28px;
          }
        }
        .loading{
          position:absolute;
          top:0px;
          left: 0px;
          width: 100%;
          height: 100%;
          z-index: 1800;
          background-color: #000000;
          opacity: 0.7;
          img{
            width: 130px;
            margin: 300px auto;;
          }
        }
      }
    }
    


    @keyframes Glow {
        from {
            box-shadow: 0 0 1px #ffffff,
                        0 0 8px #ffffff,
                        0 0 9px #ffffff,
                        0 0 13px #ffffff,
                        0 0 16px #ffffff;
        }
        to {
            box-shadow: 0 0 0px #ffffff,
                        0 0 0px #ffffff,
                        0 0 0px #ffffff,
                        0 0 0px #ffffff,
                        0 0 0px #ffffff;
        }
    }

   .active{
      
      color: #fff;
      background-color: #00a67c;
      font-weight: bold;
    } 
    .end{
      color:#ddd;
    }
    .act{
      -webkit-animation: Glow 2.0s ease infinite alternate;
      animation: Glow 2.0s ease infinite alternate;
      display:inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 13px;
      background-color:#ffffff;
    }

    @keyframes Glow2 {
        from {
            box-shadow: 0 0 3px #00a67c,
                        0 0 8px #00a67c,
                        0 0 9px #00a67c,
                        0 0 13px #00a67c,
                        0 0 16px #00a67c;
        }
        to {
            box-shadow: 0 0 3px #00a67c,
                        0 0 3px #00a67c,
                        0 0 3px #00a67c,
                        0 0 3px #00a67c,
                        0 0 3px #00a67c;
        }
    }
    .act2d{
      -webkit-animation: Glow2 0.5s ease infinite alternate;
      animation: Glow2 0.5s ease infinite alternate;
      background-color:#00a67c;
    }
}



</style>
<template>
<div class="znch">
  <div class="top">
    <div id="svg" class="svgl svg" >
      <div  class="loading" id="pload">
        <center>
        <img :src="publicPath+'loading.gif'" />
        </center>
      </div>

      <!--選擇-->
      <div class="logo" id="logo"  :style="{left:(w2-10-160)/2+'px'}">
        <Dropdown class="drop" :style="{color:pageview==3?'#fff':'#222'}" @on-click="drophld">
          <a href="javascript:void(0)" :style="{color:pageview==3?'#fff':'#222'}">
              {{boiler}}
              <Icon type="ios-arrow-down"></Icon>
          </a>
          <DropdownMenu slot="list" >
              <DropdownItem v-for="(item,index) in boilers" :selected="item.id==boilerid" :name="item.k_Name_kw"  v-bind:key="'iuyiy'+index">{{item.k_Name_kw}}</DropdownItem>
          </DropdownMenu>
        </Dropdown>
        <!-- <span class="time" :style="{color:pageview==3?'#fff':'#222'}">{{boilertime}}</span> -->
      </div>

      <!--主页面-->
      <div  id="d3" class="allp" ></div>


      <div id="way" class="liumian" ></div>



      
      <!-- 吹灰侧边栏 -->
      <!-- <div id="queue" class="queue" >
        <div class="btn" @click="togle">
          <img :src="cebtn" />
          <div class="wenzi">吹灰列表</div>
        </div>
        <div class="q">
          <div class="waith" >
            <div class="t1">序号</div>
            <div class="t2">编号</div>
            <div class="t3">时间</div>
          </div>
          <div class="wait" >
            <div style="width:100%;height:30px;" v-for="(info,iop) in waitlist" v-bind:key="'oop'+iop">
              <div class="t1">{{iop+1}}</div>
              <div class="t2">{{info.dncChqpoint_Name}}</div>
              <div class="t3">{{info.addTime}}</div>
            </div>
            
          </div>
          <Button  :disabled="waitlist.length==0" @click="okchui" type="primary" style="margin:2px 70px">吹灰执行</Button>

        </div>
      </div> -->

      <!-- 空预器 -->
      <!-- <div id="queue1" class="queue1" v-if="loadok==1">
        <div class="btn" @click="togle1">
          <img :src="cebtn1" />
          <div class="wenzi">空预器</div>
        </div>
        <div class="q">
          <div class="runh" >
            <div class="t1">编号</div>
            <div class="t2">时间</div>
          </div>
          <div class="run" >
            <div    style="width:100%;height:30px;" v-for="(info,iop) in kyqlist" v-bind:key="'kyqlist'+iop">
              <div class="t1"><span ></span>{{info.name_kw}}</div>
              <div class="t2">{{info.addTime}}</div>
  
            </div>
          </div>
          <Button  :disabled="kyqlist.length==0" @click="okchui2" type="primary" style="margin:2px 70px">吹灰执行</Button>

        </div>
      </div> -->





    </div>

    <div class="svg2"  >
      <div  class="btn" @click="gogo('/znrs/rl')">燃料数据</div>
      <div  class="btn" @click="gogo('/znrs/hz')">灰渣可燃物</div>
      <div  class="btn2">
        <div  class="n">{{parseFloat(zqll).toFixed(2)}}<sub>t/h</sub></div>
        <div  class="l">主蒸汽流量</div>
      </div>
      <div  class="btn2" @click="gogo('/znrs/zzqwd')">
        <div  class="n">{{parseFloat(zzqwd).toFixed(2)}}<sub>℃</sub></div>
        <div  class="l">主蒸汽温度</div>
      </div>
      <div  class="btn2">
        <div  class="n">{{parseFloat(zqyl).toFixed(2)}}<sub>MPa</sub></div>
        <div  class="l">主蒸汽压力</div>
      </div>
      <div  class="list">
        <div class="l">
          <div :class="'n '+ (ch==0?' act1':'')" @click="chclick">吹灰列表</div>
          <div :class="'n n2 '+ (ch==1?' act1':'')" @click="chclick">空预器</div>
        </div>
        <div class="q" v-if="ch==0">
          <div class="waith" >
            <div class="t1">序号</div>
            <div class="t2">编号</div>
            <div class="t3">时间</div>
          </div>
          <div class="wait" >
            <div style="width:100%;height:30px;" v-for="(info,iop) in waitlist" v-bind:key="'oop'+iop">
              <div class="t1">{{iop+1}}</div>
              <div class="t2">{{info.dncChqpoint_Name}}</div>
              <div class="t3">{{info.addTime}}</div>
            </div>
          </div>
          <Button type="primary" shape="circle" icon="md-play" class="b" :disabled="waitlist.length==0" @click="okchui" title="吹灰执行"></Button>
        </div>


        <div class="q"  v-if="ch==1">
          <div class="runh" >
            <div class="t1">编号</div>
            <div class="t2">时间</div>
          </div>
          <div class="run" >
            <div    style="width:100%;height:30px;" v-for="(info,iop) in kyqlist" v-bind:key="'kyqlist'+iop">
              <div class="t1"><span ></span>{{info.name_kw}}</div>
              <div class="t2">{{info.addTime}}</div>
            </div>
          </div>
          <Button  :disabled="kyqlist.length==0" @click="okchui2" type="primary" shape="circle" icon="md-play" class="b"  title="吹灰执行"></Button>
        </div>


      </div>
    </div>

  </div>
  <div class="btm">
    <div class="svgl svg2"  >
      <div class="h"  >锅炉状态监测</div>
      <div class="item">
        <div class="t1"  @click="gogo('/znrs/cw')"><Icon type="md-egg"  />锅炉床温</div>
        <div class="t2"  >
          <div class="k"  >
            <div class="t"  >{{Cw_1}}</div>
            <div class="s"  ><div class="sj"  ></div></div>
          </div>

          <div class="k" style="left:60%;color:#F75000;" >
            <div class="t"  style="border:1px solid #F75000;">{{Cw_2}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #F75000;"></div></div>
          </div>

          <div class="k" style="left:80%;color:#CE0000;" >
            <div class="t"  style="border:1px solid #CE0000;">{{Cw_3}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
          </div>


          <div :class="'tt '+ (Cw_2 > Cw_High?'hong ':' ')+ (Cw_2 >=Cw_Low && Cw_2<=Cw_High?'lv ':' ')"   >
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" Cw_2 >=Cw_Low && Cw_2<=Cw_High"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if="Cw_2 > Cw_High"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>床温高</div>
          <div class="ii"  v-if="Cw_2 < Cw_Low"><Icon type="ios-thermometer-outline"  size="25" style="color:blue;margin-top:2px"/><br>床温低</div>
        </div>
      </div>
      <div class="item">
        <div class="t1" @click="gogo2('/znrs/bw','dg')" ><Icon type="md-egg"  />低过壁温</div>
        <div class="t2"  >

          <div class="k" style="left:80%;color:#CE0000;" >
            <div class="t"  style="border:1px solid #CE0000;">{{bw1}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
          </div>


          <div :class="'tt '+ (bw1 >Bw_dg?'hong ':' ') + (bw1 <=Bw_dg?'lv ':' ')"  >
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" bw1 <=Bw_dg"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if=" bw1 >Bw_dg"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>壁温高</div>
        </div>
      </div>
      <div class="item">
        <div class="t1"  @click="gogo2('/znrs/bw','pg')" ><Icon type="md-egg"  />屏过壁温</div>
        <div class="t2"  >
          <div class="k" style="left:80%;color:#CE0000;" >
            <div class="t"  style="border:1px solid #CE0000;">{{bw2}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
          </div>

          <div :class="'tt '+ (bw2 >Bw_pg?'hong ':' ') + (bw2 <=Bw_pg?'lv ':' ')"   >
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" bw2 <=Bw_pg"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if=" bw2 >Bw_pg"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>壁温高</div>
        </div>
      </div>
      <div class="item">
        <div class="t1"  @click="gogo2('/znrs/bw','gg')" ><Icon type="md-egg"  />高过壁温</div>
        <div class="t2"  >
          <div class="k" style="left:80%;color:#CE0000;" >
            <div class="t"  style="border:1px solid #CE0000;">{{bw3}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
          </div>
          <div :class="'tt '+ (bw3 >Bw_gg?'hong ':' ') + (bw3 <=Bw_gg?'lv ':' ')" >
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" bw3 <=Bw_gg"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if=" bw3 >Bw_gg"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>壁温高</div>
        </div>
      </div>
      <div class="item">
        <div class="t1"  ><Icon type="md-egg"  />省煤器压差</div>
        <div class="t2"  >
          <div class="k" style="left:80%;color:#CE0000;" >
            <div class="t"  style="border:1px solid #CE0000;">{{sm}}</div>
            <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
          </div>
          <div :class="'tt '+ (sm >Yc_sm  ?'hong ':' ') + (sm <= Yc_sm ?'lv ':' ')" >
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" sm <= Yc_sm"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if=" sm >Yc_sm"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>压差大</div>
        </div>
      </div>
      <div class="item">
        <div class="t1"  ><Icon type="md-egg"  />预热器压差</div>
        <div class="t2"  >
          <div class="k" style="left:80%;color:#CE0000;" >
              <div class="t"  style="border:1px solid #CE0000;">{{yr}}</div>
              <div class="s"  ><div class="sj"  style="border-color: transparent transparent #CE0000;"></div></div>
            </div>
          <div :class="'tt '+ (yr >Yc_yr  ?'hong ':' ') + (yr <= Yc_yr ?'lv ':' ')"  >
            
            <div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div><div class="t"></div>
          </div>
        </div>
        <div class="t3"  >
          <div class="ii"  v-if=" yr <= Yc_yr"><Icon type="md-checkmark-circle" size="25" style="color:green;margin-top:2px"/><br>正常</div>
          <div class="ii"  v-if=" yr >Yc_yr"><Icon type="ios-thermometer" size="25" style="color:red;margin-top:2px"/><br>压差大</div>
        </div>
      </div>
    </div>
    <div class="svg2"  >
      
      <div class="you"  style="color:#DAA520;cursor:pointer;" @click="gogo('/znrs/lv')">
        <div class="t"  style="border:3px solid #DAA520;font-size:32px;line-height:419%" >
          {{parseFloat(boilerPositive).toFixed(2)}}%
        </div>
        <div class="b"  style="color:#DAA520"><Icon type="md-square" />&nbsp;锅炉效率(正)</div>
      </div>
      
      <div class="you"  style="color:#FFA500;cursor:pointer;" @click="gogo('/znrs/lv')">
        <div class="t"  style="border:3px solid #FFA500;font-size:32px;line-height:419%" >
          {{parseFloat(boilerCounter).toFixed(2)}}%
        </div>
        <div class="b"  style="color:#FFA500"><Icon type="md-square" />&nbsp;&nbsp;锅炉效率(反)</div>
      </div>
      <div class="you"  style="color:#228B22;"  >
        <div class="t"  style="border:3px solid #228B22;font-size:32px;line-height:419%" >
          {{dsl}}%
        </div>
        <div class="b"  style="color:#228B22"><Icon type="md-square" />&nbsp;&nbsp;堵塞概率</div>
      </div>
      <div class="you"  >
        <div class="t"  >
          --:--:--
        </div>
        <div class="b"  ><Icon type="md-square" />&nbsp;运行时长(h)</div>
      </div>
    </div>
  </div>
</div>
</template>

<script>
import store from '@/store'
//工具包
import { getDateMore,sortBy,gradientColor,getDate ,eqarr} from "@/libs/tools";
//机组
import { getBoilerListAll } from "@/api/ZNRS/Dncboiler";
import anime from 'animejs/lib/anime.js';
//echart数据
import {  } from '_c/charts'
import ECharts from "vue-echarts";
// 柱状图
import "echarts/lib/chart/bar";
// 折线
import "echarts/lib/chart/line";
// 饼状图
//import "echarts/lib/chart/pie";
// 提示
import "echarts/lib/component/tooltip";
import "echarts/lib/component/title";
//热力图
import "echarts/lib/chart/heatmap";
import "echarts/lib/component/visualMap";
// 图例

// import "echarts/lib/component/markPoint";
// import "echarts/lib/component/markLine";
// import "echarts/lib/component/graphic";
//标题
import "echarts/lib/component/legend";
import {
  getHzpointnowList
} from "@/api/ZNRS/Dnchzpointnow";
//c吹灰队列
import {
  getChlistList,dochui,dochui2
} from "@/api/ZNRS/Dncchlist";

import {
  getParameterList,
} from "@/api/ZNRS/Dncparameter";
import {
  getPointkks_dataList
} from "@/api/ZNRS/Dncpointkks_data";
import {
  getHzpointList
} from "@/api/ZNRS/Dnchzpoint";
import {
  getChqpointList,
} from "@/api/ZNRS/Dncchqpoint";
import {
  getChareaList
} from "@/api/ZNRS/Dnccharea";
import {
  getChrunlist_kyqList
} from "@/api/ZNRS/Dncchrunlist_kyq";

//右键菜单
import VueContextMenu from 'vue-contextmenu/src/VueContextMenu';
//threejs
import * as THREE from 'three';
// import {MTLLoader, OBJLoader} from 'three-obj-mtl-loader';
import { OrbitControls } from 'three/examples/js/controls/CCC';
import { CSS2DRenderer, CSS2DObject } from 'three/examples/jsm/renderers/CSS2DRenderer';
import { ColladaLoader } from 'three/examples/js/loaders/LLL';

import { STLLoader } from 'three/examples/js/loaders/STLLoader';


// import stats from 'stats-js';
// import dat from 'dat.gui';
import { ibs,ias} from "@/api/chuihui/point";

import chu from "@/assets/images/chu.png";
import ru from "@/assets/images/ru.png";
import pic2d from "@/assets/images/2d.svg";

//ziti
// import EEE from "@/assets/font/iconfont.css";
export default {
  name: "ZNRS_znch_page",
  components: {
    "vue-context-menu" : VueContextMenu,
     "v-chart": ECharts
  },
  data() {
    return {

      Cw_High:0,
      Cw_Low:0,
      Bw_dg:0,
      Bw_pg:0,
      Bw_gg:0,
      Yc_sm:0,
      Yc_yr:0,

      Cw_1:0,
      Cw_2:0,
      Cw_3:0,
      bw1:0,
      bw2:0,
      bw3:0,
      sm:0,
      yr:0,




      ch:0,
      boilerPositive:"",//（正平衡）
      boilerCounter:"",//（反平衡）
      zqll:"",
      zqyl:"",
      zzqwd:"",
      dsl:"",
      loop:true,
      paramobj:{},
      //背火侧温差临界值
      ljz:40,
      ljzcolorstep:[],
      wrldmes:{
        pg_z:[],
        pg_y:[],
        gg_z:[],
        gg_y:[],
        gz_z:[],
        gz_y:[],
        dz_z:[],
        dz_y:[],
        dg_z:[],
        dg_y:[],
        zs_z:[],
        zs_y:[],
        fjs:[]
      },
      colorstep:[],
      huikan:{
        modal2:false,
        title:"",
        timebe:[],
        data:{}
      },
      //吹灰总时长
      chuilong:0,
      //执行列表加入时间
      runtime:'',
      runtimekyq:'',
      waitlist:[],
      runlist:[],
      kyqlist:[],
      chuirun:0,
      lll:'',
      loadok:0,loadok1:0,
      chu,ru,cebtn:ru,pic2d,
      cebtn1:ru,
      time2d:'',
      //3d 2d
      pageview:3,
      //three 
      publicPath: process.env.BASE_URL,
      scene: null,
      camera: null,
      renderer: null,
      labelRenderer:null,
      controls:null,
      st:null,
      rotationSpeed: 0.02,

      scene2: null,
      camera2: null,
      renderer2: null,

      btncolors:['#c23531','#2f4554','#61a0a8'],

      timer2:null,

      //机组
      boilertime:"",
      boilerid:-1,
      boiler:"",
      boilerNowStatus:-1,
      boilerSta_time:"",
      boilers:[],

      h2:0,
      w2:0,

      x:0,
      y:0,
      z:0,

      ir_points:[],
      ik_points:[],
      il_points:[],
      ia_points:[],


      ir_rouletteScene:[],
      ib_rouletteScene:[],
      il_rouletteScene:[],
      ia_rouletteScene:[],

      templist:[],
      pointall:[],
      errlist:[],
      justlistc:[],justlistmes:[],
      jiaoti:1,fx:1,


      queues:[],
      queueshis:[],

      trans:0,
      tamap:{},
      scales:0,

      //lable
      lables:[],


      idandwd:[],
      //2d
      data2d:[
        {h:'左墙',w:[1,2,3,5],item:[
          {y:['IR78','IR77','IR76','IR75','IR74','IR73'],b:90},
          {y:['IR54','IR53','IR52','IR51','IR50','IR49'],b:90},
          {y:['IR30','IR29','IR28','IR27','IR26','IR25'],b:90},
          {y:['IR6','IR5','IR4','IR3','IR2','IR1'],b:90}
        ]},
        {h:'前墙',w:[1,2,3,5],item:[
          {y:['IR96','IR95','IR94','IR93','IR92','IR91'],b:90},
          {y:['IR72','IR71','IR70','IR69','IR68','IR67'],b:90},
          {y:['IR48','IR47','IR46','IR45','IR44','IR43'],b:90},
          {y:['IR24','IR23','IR22','IR21','IR20','IR19'],b:90}
        ]},
        {h:'右墙',w:[1,2,3,5],item:[
          {y:['IR90','IR89','IR88','IR87','IR86','IR85'],b:90},
          {y:['IR66','IR65','IR64','IR63','IR62','IR61'],b:90},
          {y:['IR42','IR41','IR40','IR39','IR38','IR37'],b:90},
          {y:['IR18','IR17','IR16','IR15','IR14','IR13'],b:90}
        ]},
        {h:'后墙',w:[1,2,3,5],item:[
          {y:['IR79','IR80','IR81','IR82','IR83','IR84'],b:90},
          {y:['IR55','IR56','IR57','IR58','IR59','IR60'],b:90},
          {y:['IR31','IR32','IR33','IR34','IR35','IR36'],b:90},
          {y:['IR7','IR8','IR9','IR10','IR11','IR12'],b:90}
        ]}
      ],
      mini2d:0,
      mg1:0,mg2:0,tipmes:"",

      ccdada:[
        {n:'屏式过热器',l:0,r:0,h:0},
        {n:'高温过热器',l:0,r:0,h:0},
        {n:'高温再热器',l:0,r:0,h:0},
        {n:'低温再热器',l:0,r:0,h:0},
        {n:'低温过热器',l:0,r:0,h:0},
        {n:'主省煤器',l:0,r:0,h:0},
        {n:'分级省煤器',l:0,h:0},
        {n:'空气预热器',l:0,h:0}
      ],


    }
  },
  watch:{
    
  },
  computed:{
  },
  methods: {
    chclick(){
      let o=this;
      if (o.ch==0) {
        o.ch=1;
      }else{
        o.ch=0;
      }
    },
    gogo(item){
       this.$router.push(item+"/"+this.boilerid+"/6");
    },
    gogo2(item,bw){
       this.$router.push(item+"/"+this.boilerid+"/"+bw);
    },
    drophld(name){
      this.boilers.map(o=>{
        if(o.k_Name_kw==name){
          this.boilerid=o.id;
          this.boiler=o.k_Name_kw;
          this.boilertime=o.syntime;
          // this.loadXYQList(this.boilerid,1);
          this.Cw_High=o.cw_High;
          this.Cw_Low=o.cw_Low;
          this.Bw_dg=o.bw_dg;
          this.Bw_pg=o.bw_pg;
          this.Bw_gg=o.bw_gg;

          this.boilerPositive=o.positive;
          this.boilerCounter=o.counter;
          this.quenlist(this.boilerid);
          this.initpoint(this.boilerid);
        }
      });
      
    },
    togle(){
      let t=document.querySelectorAll(".queue");
      if(this.cebtn==this.ru){
        this.cebtn=this.chu;
        anime({
            targets: t[0],
            translateX: 218,
            duration: 1000
          });
      }else{
        this.cebtn=this.ru;
        anime({
            targets: t[0],
            translateX: 0,
            duration: 1000
          });
      }
    },
    togle1(){
      let t=document.querySelectorAll(".queue1");
      if(this.cebtn1==this.ru){
        this.cebtn1=this.chu;
        anime({
            targets: t[0],
            translateX: 218,
            duration: 1000
          });
      }else{
        this.cebtn1=this.ru;
        anime({
            targets: t[0],
            translateX: 0,
            duration: 1000
          });
      }
    },
    chooceview(u){
      this.pageview=u;
    },
    initway(){
      let o=this;
      let container = document.getElementById('way');
      o.scene2 = new THREE.Scene();
      // o.camera2 = new THREE.PerspectiveCamera(60, 200 / 200, 0.1, 10);
      // o.camera2.position.set( 0.1, 0.2, 0.5 );
      o.renderer2 = new THREE.WebGLRenderer({
        antialias: true, // true/false表示是否开启反锯齿
        alpha: false, // true/false 表示是否可以设置背景色透明
        precision: 'highp', // highp/mediump/lowp 表示着色精度选择
        premultipliedAlpha: false, // true/false 表示是否可以设置像素深度（用来度量图像的分辨率）
        preserveDrawingBuffer: true, // true/false 表示是否保存绘图缓冲
        maxLights: 3, // 最大灯光数
        stencil: false // false/true 表示是否使用模板字体或图案
      });
      o.renderer2.setSize(200, 200 * o.h2/(o.w2*0.8)  );

      // let controls = new OrbitControls(o.camera2, o.renderer2.domElement);
      // controls.target.set(0, 0, 0);// 设置控制器的焦点，使控制器围绕这个焦点进行旋转
      // controls.update();// 照相机转动时，必须更新该控制器

      container.appendChild(o.renderer2.domElement);

      o.scene2.add(new THREE.AmbientLight(0xffffff));
      var loader = new ColladaLoader();
      loader.load(`${o.publicPath}model/way.dae`, function( collada ){
        //将模型的场景加入到整体的场景
        let rouletteScene = collada.scene;
        rouletteScene.scale.set(0.05,0.05,0.05);
        o.scene2.add(rouletteScene);
      },
      function( xhr) {
        //console.log((xhr.loaded/xhr.total * 100)+"% loaded");
      });

      
    },
    //5mian 刷一次，吹运行中的点位u
    chui(u){
      let o=this;
      o.trans=0;

      if(Object.keys(o.tamap).length==0){
        o.templist.map(x=>{
          if(x.updown==0){
            let q=x.name_kw;
            q=q.toLowerCase();
            if(!o.tamap.hasOwnProperty(q)){
              o.tamap[q]=0;
            }
          }
        });
      }
      
      o.scales=0;
      let t=[];
      u.map(x=>{
        t.push(x.name_kw);
      });
      o.queueshis=o.queues;
      o.queues=t;
      o.chuisingle();
    },
    //场景加风扇
    chuisingle(){
      let o=this;
      let exit=eqarr(o.queueshis,o.queues);
      if(exit){
        return;
      }
      //还原退回map
      o.tamap={};
      //清空扇叶
      o.ir_rouletteScene.map(x=>{
        o.scene.remove(x);
      });
      o.ib_rouletteScene.map(x=>{
        o.scene.remove(x);
      });
      o.il_rouletteScene.map(x=>{
        o.scene.remove(x);
      });
      o.ia_rouletteScene.map(x=>{
        o.scene.remove(x);
      });
      //还原钢管
      // o.ir_points.map(x=>{
      //   x.scale.y=1;
      // });
      // o.ik_points.map(x=>{
      //   x.scale.y=1;
      // });
      // o.il_points.map(x=>{
      //   x.scale.y=1;
      // });
      // o.ia_points.map(x=>{
      //   x.scale.y=1;
      // });
      //加风扇
      for (let index = 0; index < o.queues.length; index++) {
          let element = o.queues[index];
          let key=element.substr(0,2).toLowerCase();
          let i=parseInt(element.substr(2));
          
          if(key=="ir"){
            o.scene.add(o.ir_rouletteScene[i-1]);
          }else if(key=="ik"){
            o.scene.add(o.ib_rouletteScene[i-1]);
          }else if(key=="il"){
            o.scene.add(o.il_rouletteScene[i-1]);
          }else if(key=="ia"){
            o.scene.add(o.ia_rouletteScene[i-1]);
          }
      }
    },

    init() {
      let o=this;
      let container = document.getElementById('d3');

      o.scene = new THREE.Scene();
      o.camera = new THREE.PerspectiveCamera(60, (o.w2-10) / o.h2, 0.1, 10);
      o.camera.position.set( 0.1, 0.2, 0.5 );
      o.camera2 = new THREE.PerspectiveCamera(60, o.w2*0.8 / o.h2, 0.1, 10);
      o.camera2.position.set( 0.1, 0.2, 0.5 );

      var loader = new ColladaLoader();

      loader.load(`${o.publicPath}model/fs.dae`, function( collada ){
        let rouletteScene = collada.scene;
        rouletteScene.scale.set(0.09,0.09,0.09);


        let kk=ibs({x:o.x,z:o.z,y:o.y,col:rouletteScene});
        o.ib_points=kk[0];
        //长吹
        o.ib_points.map(mess=>{
          o.scene.add( mess );
        });
        o.ib_rouletteScene=kk[1];

        let aa=ias({x:o.x,z:o.z,y:o.y,col:rouletteScene});
        o.ia_points=aa[0];
        //长吹
        o.ia_points.map(mess=>{
          o.scene.add( mess );
        });
        o.ia_rouletteScene=aa[1];


        o.chuisingle();

        //loading close
        let loading=document.querySelectorAll("#pload");
        loading[0].style.display="none";
        o.loadok=1;
      },
      function( xhr) {
        //ole.log((xhr.loaded/xhr.total * 100)+"% loaded");
      });


      let t=0;
      let loader2 = new STLLoader();
			loader2.load( `${o.publicPath}model/1.stl`, function ( geometry ) {
          let material = new THREE.MeshPhongMaterial( { color: 0x009ad6, specular: 0x666666, shininess: 200 } );
          material.opacity = 0.8 ;
          material.transparent = true ;
					let mesh = new THREE.Mesh( geometry,material );
					mesh.scale.set(0.1,0.1,0.1);
          mesh.rotation.z = 0;
          mesh.rotation.x = -1.56;
          mesh.rotation.y = 0;
					o.scene.add( mesh );
			});
      loader2.load( `${o.publicPath}model/2.stl`, function ( geometry ) {
          let material = new THREE.MeshPhongMaterial( { color: 0xffffff, specular: 0x111111, shininess: 200 } );
          material.opacity = 0.8 ;
          material.transparent = true ;
					let mesh = new THREE.Mesh( geometry,material );
					mesh.scale.set(0.1,0.1,0.1);
          mesh.rotation.z = 0;
          mesh.rotation.x = -1.56;
          mesh.rotation.y = 0;
					o.scene.add( mesh );
			});
      o.wrldmes={
        pg_z:[],
        pg_y:[],
        gg_z:[],
        gg_y:[],
        gz_z:[],
        gz_y:[],
        dz_z:[],
        dz_y:[],
        dg_z:[],
        dg_y:[],
        zs_z:[],
        zs_y:[],
        fjs:[]
      };


      //面
      let grid = new THREE.GridHelper(1, 20, 0x883333, 0x444444);
      grid.position.set(0, -0.16, 0);
      grid.material.transparent = true;
      o.scene.add(grid);

      


      o.renderer = new THREE.WebGLRenderer({
        antialias: true, // true/false表示是否开启反锯齿
        alpha: false, // true/false 表示是否可以设置背景色透明
        precision: 'highp', // highp/mediump/lowp 表示着色精度选择
        premultipliedAlpha: false, // true/false 表示是否可以设置像素深度（用来度量图像的分辨率）
        preserveDrawingBuffer: true, // true/false 表示是否保存绘图缓冲
        maxLights: 1, // 最大灯光数
        stencil: false // false/true 表示是否使用模板字体或图案
      });
      o.renderer.setSize(o.w2-10, o.h2);


      o.labelRenderer = new CSS2DRenderer();
      o.labelRenderer.setSize(o.w2-10, o.h2);
      o.labelRenderer.domElement.style.position = 'absolute';
      o.labelRenderer.domElement.style.top = '0px';
      container.appendChild(o.labelRenderer.domElement);


      o.controls = new OrbitControls(o.camera,o.labelRenderer.domElement);
      o.controls.target.set(0, 0, 0);// 设置控制器的焦点，使控制器围绕这个焦点进行旋转
      o.controls.update();// 照相机转动时，必须更新该控制器
        
      container.appendChild(o.renderer.domElement);


      let raycaster = new THREE.Raycaster();
      let mouse = new THREE.Vector2();
      o.labelRenderer.domElement.addEventListener("mousemove", (event) => {
        // console.log(1);
          // mouse.x = (event.clientX / o.labelRenderer.domElement.clientWidth) * 2 - 1 - 0.1;
          // mouse.y = -(event.clientY / o.labelRenderer.domElement.clientHeight) * 2 + 1 + 0.1 ;
          
          mouse.x = (event.clientX / o.labelRenderer.domElement.clientWidth) * 2 - 1-0.01;
          mouse.y = -(event.clientY / o.labelRenderer.domElement.clientHeight) * 2  + 1+0.01;
          

          
          raycaster.setFromCamera(mouse, o.camera);
          let objects=o.ib_points.concat(o.ia_points);
          let intersects = raycaster.intersectObjects(objects);
         // console.log(intersects.length);
          
          if (intersects.length > 0) {
              let obj = intersects[0].object;
              o.showlable(obj);
          }else{
              o.clearlable();
          }

      })


      //环境光会均匀的照亮场景中的所有物体。
      // o.scene.add(new THREE.AmbientLight("#ccffcc"));

      var pointLight = new THREE.PointLight("#ccffcc");
      pointLight.position.set(0.3,0.3,0.3);
      pointLight.intensity = 1.2;
      o.scene.add(pointLight);

      var pointLight2 = new THREE.PointLight("#ccffcc");
      pointLight2.position.set(-0.3,-0.3,-0.3);
      pointLight2.intensity = 1.2;
      o.scene.add(pointLight2);
    },
    blow(){
      let o=this;
      //找退回的点
      o.templist.map(x=>{
        if(x.updown==0){
          let q=x.name_kw;
          q=q.toLowerCase();
          let i=parseInt(q.substr(2));
          if(q.indexOf("ir")!=-1){
            o.__blowingir(i);
          }else if(q.indexOf("ik")!=-1){
            o.__blowingik(i);
          }else if(q.indexOf("il")!=-1){
            o.__blowingil(i);
          }else if(q.indexOf("ia")!=-1){
            o.__blowingia(i);
          }
        }
      });



      o.queues.map(q=>{
        q=q.toLowerCase();
        //["ir1","ik2"]
        let i=parseInt(q.substr(2));
        if(q.indexOf("ir")!=-1){
          o.blowingir(i);
        }else if(q.indexOf("ik")!=-1){
          o.blowingik(i);
        }else if(q.indexOf("il")!=-1){
          o.blowingil(i);
        }else if(q.indexOf("ia")!=-1){
          o.blowingia(i);
        }
      });
      
      o.queueshis.map(q=>{
        q=q.toLowerCase();
        //["ir1","ik2"]
        let i=parseInt(q.substr(2));
        if(q.indexOf("ir")!=-1){
          o._blowingir(i);
        }else if(q.indexOf("ik")!=-1){
          o._blowingik(i);
        }else if(q.indexOf("il")!=-1){
          o._blowingil(i);
        }else if(q.indexOf("ia")!=-1){
          o._blowingia(i);
        }
      });
      o.trans += 0.001;
      o.scales += 0.1;


      if(Object.keys(o.tamap).length>0){
        o.templist.map(x=>{
          if(x.updown==0){
            let q=x.name_kw;
            q=q.toLowerCase();
            if(o.tamap.hasOwnProperty(q)){
              o.tamap[q]=o.tamap[q]+0.001;
            }
          }
        });
      }
    },
    animate() {
      let o=this;
      //开始吹啊。。
      if(o.ia_rouletteScene.length>0){
        o.blow();
      }

      if(o.justlistc.length>0){
        o.pointlight();
      }
      


      requestAnimationFrame(o.animate);

      let l = 0.1*0.1 + 0.2*0.2 + 0.5*0.5;
      let m = o.camera.position.x*o.camera.position.x + o.camera.position.y*o.camera.position.y + o.camera.position.z*o.camera.position.z;

      let jg=[];
      jg=o.clsxyz(l,o.camera.position.x,o.camera.position.y,o.camera.position.z);
      if(jg.length>0){
        o.camera2.position.x=jg[0];
        o.camera2.position.y=jg[1];
        o.camera2.position.z=jg[2];
      }else{
        o.camera2.position.x=o.camera.position.x;
        o.camera2.position.y=o.camera.position.y;
        o.camera2.position.z=o.camera.position.z;
      }

      o.camera2.lookAt(o.scene2.position);
      o.renderer.render(o.scene, o.camera);
      o.renderer2.render(o.scene2, o.camera2);
      o.labelRenderer.render(o.scene, o.camera);
    },

    clsxyz(l,x,y,z){
      let jindu=0.010000;
      let arr=[];
      let x1=0,y1=0,z1=0;
      x1=x;y1=y;z1=z;
      let jli=0.036;
      for (let j = 0; j < 10; j++) {
        //变远
        for (let index = 1; index <= 50; index++) {
          x1=x1*(1+jindu*index);
          y1=y1*(1+jindu*index);
          z1=z1*(1+jindu*index);
          let m = x1*x1 +y1*y1 + z1*z1;
          if(Math.abs(l-m)<jli){
            arr.push(x1);
            arr.push(y1);
            arr.push(z1);
            break;
          }
        }
        if(arr.length==0){
          //变近
          x1=x;y1=y;z1=z;
          for (let index = 1; index <= 50; index++) {
            x1=x1*(1-jindu*index);
            y1=y1*(1-jindu*index);
            z1=z1*(1-jindu*index);
            let m = x1*x1 +y1*y1 + z1*z1;
            if(Math.abs(l-m)<jli){
              arr.push(x1);
              arr.push(y1);
              arr.push(z1);
              break;
            }
          }
        }
        
        if(arr.length==0){
          jli+=0.003;//允许距离加大再算算
          continue;
        }else{
          break;
        }
      }

      
      
      return arr;
    },
    

    //右侧队列
    quenlist(bid){
      let o=this;
      getChlistList({
            totalCount: 0,
            pageSize: 200,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: 1,
            boilerid:bid,
            sort: [
              {
                direct: "ASC",
                field: "id"
              }
            ]
          }).then(res => {
        o.waitlist = getDateMore(res.data.data,5,["addTime"]);

      });



      // k空预器
      getChrunlist_kyqList({
            totalCount: 0,
            pageSize: 20,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: -1,
            boilerid:bid,
            sort: [
              {
                direct: "DESC",
                field: "id"
              }
            ]
          }).then(res => {
            o.kyqlist=getDateMore(res.data.data,5,["addTime","runTime","offTime",]);
            if(o.kyqlist.length>0){
              o.runtimekyq=o.kyqlist[0].addTime;
            }else{
              o.runtimekyq='';
            }
            
        // this.stores.Chrunlist_kyq.data = getDateMore(res.data.data,1,["addTime","runTime","offTime",]);
        // this.stores.Chrunlist_kyq.query.totalCount = res.data.totalCount;
      });


      getHzpointnowList({
            totalCount: 0,
            pageSize: 2000,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: -1,
            boilerid: bid,
            t:"12,11",
            sort: [
              {
                direct: "DESC",
                field: "id"
              }
            ]
          }).then(res => {
            let d= getDateMore(res.data.data,2,["realTime",]);
            if(d.filter(x=>x.dncTypeId==11)[0]){
              let v1= eval("("+d.filter(x=>x.dncTypeId==11)[0].pvalue+")")  ;//压力
              let s1=0;
              v1.map(x=>{
                s1+=x;
              });
              o.zqyl=s1/v1.length;
            }else{
              o.zqyl="";
            }
            if(d.filter(x=>x.dncTypeId==12)[0]){
              let v2= eval("("+d.filter(x=>x.dncTypeId==12)[0].pvalue+")")   ;//流量
              let s2=0;
              v2.map(x=>{
                s2+=x;
              });
              o.zqll=s2/v2.length;
            }else{
              o.zqll="";
            }
      });
      //平均温度
      getHzpointList({
            totalCount: 0,
            pageSize: 20,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: -1,
            boilerid: bid,
            t:"10",
            sort: [
              {
                direct: "DESC",
                field: "id"
              }
            ]
          }).then(res => {
            let d= getDateMore(res.data.data,2,["realTime",]);
            let arr=eval("("+d[0].pvalue+")") ;
            let sum=0;
            for (let index = 0; index < arr.length; index++) {
              sum+=arr[index];
            }
            o.zzqwd=sum/arr.length;
      });

      //堵塞率计算
      getChareaList({
            totalCount: 0,
            pageSize: 20,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: -1,
            boilerid: bid,
            sort: [
              {
                direct: "DESC",
                field: "id"
              }
            ]
          }).then(res => {
            let d= getDateMore(res.data.data,2,["realTime",]);
            let ct=0;
            d.map(x=>{
              if(x.dsl_Val>x.dslhigh_Val){
                ct++;
              }
              // console.log(JSON.stringify(x));
              if(x.name_kw=='省煤器'){
                o.Yc_sm=x.ycHigh_Val.toFixed(2);
                o.sm=x.ckyj_Val.toFixed(2);
                // console.log(o.sm);
              }
              if(x.name_kw=='空预器'){
                o.Yc_yr=x.ycHigh_Val.toFixed(2);
                o.yr=x.ckyj_Val.toFixed(2);
              }
            });
            o.dsl= 25*ct ;


      });



      getPointkks_dataList({
            totalCount: 0,
            pageSize: 1000,
            currentPage: 1,
            kw: "",
            isDeleted: 0,
            status: -1,
            boilerid: bid,
            sort: [
              {
                direct: "DESC",
                field: "id"
              }
            ]
          }).then(res => {
            let d= getDateMore(res.data.data,2,["realTime",]);
            let t1=d.filter(x=>(x.remarks=='左墙沸下温度'||x.remarks=='右墙沸下温度'||x.remarks=='前墙#1沸上温度'||x.remarks=='前墙#2沸上温度'||x.remarks=='前墙#3沸上温度'||x.remarks=='右墙沸中温度')&& x.realTime==d[0].realTime).map(x=>{
              return x.pvalue.toFixed(2);
            });
            o.Cw_1=Math.min(...t1);
            o.Cw_2= (eval(t1.join("+"))/t1.length).toFixed(2) ;
            o.Cw_3=Math.max(...t1);

            let t2=d.filter(x=>(x.remarks=='低温过热器壁温1'||x.remarks=='低温过热器壁温2'||x.remarks=='低温过热器壁温3'||x.remarks=='低温过热器壁温4')&& x.realTime==d[0].realTime).map(x=>{
              return x.pvalue.toFixed(2);
            });
            o.bw1=(eval(t2.join("+"))/t2.length).toFixed(2) ;

            let t3=d.filter(x=>(x.remarks=='屏式过热器壁温1'||x.remarks=='屏式过热器壁温2'||x.remarks=='屏式过热器壁温3'||x.remarks=='屏式过热器壁温4')&& x.realTime==d[0].realTime).map(x=>{
              return x.pvalue.toFixed(2);
            });
            o.bw2=(eval(t3.join("+"))/t3.length).toFixed(2) ;

            let t5=d.filter(x=>(x.remarks=='高温过热器壁温1'||x.remarks=='高温过热器壁温2'||x.remarks=='高温过热器壁温3'||x.remarks=='高温过热器壁温4')&& x.realTime==d[0].realTime).map(x=>{
              return x.pvalue.toFixed(2);
            });
            o.bw3=(eval(t5.join("+"))/t5.length).toFixed(2) ;

      });




    },
    //刷点 5miao
 
    //点涂色
    pointcolor(u,color,color2d){
      let o=this;
      //2d 涂色
      u.map(u=>{
        let dian=u.name_kw;
    //    console.log(dian+"_"+color2d);
        let y2d=document.querySelectorAll("."+dian);
        for (let index = 0; index < y2d.length; index++) {
          let element = y2d[index];
          element.style.backgroundColor=color2d;
        }
      });
      

      //3d 涂色
      let path = "/";
      let urls = [
        path + "2.png", path + "2.png",
        path + "2.png", path + "2.png",
        path + "2.png", path + "2.png"
      ];

      let textureCube = new THREE.CubeTextureLoader().load(urls);
      textureCube.encoding = THREE.sRGBEncoding;
      let m=new THREE.MeshPhysicalMaterial({
          color:color,
          metalness: 1.0,
          roughness: 0.1,
          envMap: textureCube
      });

      u.map(u=>{
        let n=u.name_kw;
        n=n.toLowerCase();
        let tpe=n.substr(0,2);
        let index=n.substr(2);
        if(tpe=="ir"){
          o.ir_points[index-1].material=m;
        }else if(tpe=="ik"){
          o.ik_points[index-1].material=m;
        }else if(tpe=="il"){
          o.il_points[index-1].material=m;
        }else if(tpe=="ia"){
          o.ia_points[index-1].material=m;
        }
      });
      
    },

    //点发光
    pointlight(){
      let o=this;
      // console.log(o.justlistmes.length);
      o.justlistmes.map(u=>{
          o.donghua(u);
      });
      
    },

    donghua(mes){
      let o=this;
      if(o.jiaoti>=3){
        o.fx=0;
      }
      if(o.jiaoti<=1){
        o.fx=1;
      }
      if(o.fx==1){
        o.jiaoti+=0.05;
      }else{
        o.jiaoti-=0.1;
      }
      // let mes=mesh.clone();
      let gg=0;
      if(o.jiaoti>=2.6){
        gg=3;
      }else{
        gg=o.jiaoti;
      }
      let meshmaterial=new THREE.MeshBasicMaterial( {color: 0xFFFFFF,opacity:1-(0.1*gg*3),transparent:true});
      mes.material=meshmaterial;

      mes.scale.x = o.jiaoti;
      mes.scale.y = o.jiaoti;
      mes.scale.z = o.jiaoti;
      // mes.scale.set(o.jiaoti,o.jiaoti,o.jiaoti);
    },
    //机组加载
    initboiler(){
      let o=this;
      getBoilerListAll().then(res => {
          o.boilers=getDateMore(res.data.data,-1,["syntime",]);
          if(o.boilerid==-1){
            o.boiler=o.boilers[0].k_Name_kw;
            o.boilerid=o.boilers[0].id;
            o.boilertime=o.boilers[0].syntime;
            o.boilerPositive=o.boilers[0].positive;
            o.boilerCounter=o.boilers[0].counter;
            this.Cw_High=o.boilers[0].cw_High;
            this.Cw_Low=o.boilers[0].cw_Low;
            this.Bw_dg=o.boilers[0].bw_dg;
            this.Bw_pg=o.boilers[0].bw_pg;
            this.Bw_gg=o.boilers[0].bw_gg;
          }else{
            o.boilers.map(x=>{
              if(x.id==o.boilerid){
                o.boilertime=x.syntime;
              }
            });
            
          }
          //初始化吹灰列表
          //o.quenlist(o.boilerid);
        });
    },
    //标签
    clearlable(){
      let o=this;
      o.lables.map(x=>{
        let n=x.k;
          n=n.toLowerCase();
          let tpe=n.substr(0,2);
          let index=n.substr(2);
          if(o.ib_points[index*2-2]){
            o.ib_points[index*2-2].remove(x.v);
          }
          if(o.ia_points[index*2-2]){
            o.ia_points[index*2-2].remove(x.v);
          }
      });
      o.lables=[];
    },
    showlable(nm){
      // console.log(nm.name);
      let o=this;
      o.clearlable();
        let earthDiv = document.createElement( 'div' );
        earthDiv.id=nm.name;
        earthDiv.className = 'labeles6';
        earthDiv.innerHTML = nm.name.toUpperCase() ;
        // if(nm.name.toLowerCase().substr(0,2)=="ir"){
        //   earthDiv.style.marginTop = '-4.5em';
        // }else{
        //   earthDiv.style.marginTop = '-2.8em';
        // }   ib_points
        earthDiv.style.marginTop = '-1.8em';


        let earthLabel = new CSS2DObject( earthDiv );
        earthLabel.position.set( 0, 0, 0 );

        let index=nm.name.substr(2);


        if(nm.name.toLowerCase().substr(0,2)=="ib"){
          o.ib_points[index*2-2].add( earthLabel );
        }else{
          o.ia_points[index*2-2].add( earthLabel );
        }
        
        // let n=nm.name;
        // n=n.toLowerCase();
        // let tpe=n.substr(0,2);
        // let index=n.substr(2);
        // if(tpe=="ir"){
        //   o.ir_points[index-1].add( earthLabel );
        // }else if(tpe=="ik"){
        //   o.ik_points[index-1].add( earthLabel );
        // }else if(tpe=="il"){
        //   o.il_points[index-1].add( earthLabel );
        // }else if(tpe=="ia"){
        //   o.ia_points[index-1].add( earthLabel );
        // }
        o.lables.push({k:nm.name,v:earthLabel});
    },
    
    hanldlermove(e){
      let k177=document.querySelectorAll(".tip12");
      k177[0].style.top=e.clientY-35 +"px";
      k177[0].style.left=e.clientX-75+"px";
    },
    okchui(){
      let o=this;
      dochui({
            code:o.boilerid
          }).then(res => {
        if (res.data.code === 200) {
          this.$Message.success(res.data.message);
          
        } else {
          this.$Message.warning(res.data.message);
        }
      });
    },

    okchui2(){
      let o=this;
      dochui2({
            code:o.boilerid
          }).then(res => {
        if (res.data.code === 200) {
          this.$Message.success(res.data.message);
          
        } else {
          this.$Message.warning(res.data.message);
        }
      });
    }
  },
  mounted() {
    let o = this;

    o.colorstep=gradientColor('#ffffff','#00dd00',10);
    o.colorstep=o.colorstep.concat(gradientColor('#FF0000','#730303',3));
    o.ljzcolorstep=['#008000'].concat(gradientColor('#FF0000','#000000',o.ljz));
    // console.log(JSON.stringify(o.colorstep));

    o.h2=document.body.clientHeight/2;
    o.w2=document.body.clientWidth*6/10;

    o.mini2d=(o.w2-10)/4/6-(o.w2-10)/4/18;
    o.mg1=(o.w2-10)/4/22;
    o.mg2=-(o.w2-10)/4/6/3;
    //初始化3d
    o.init();
    //初始化左上角
    o.initway();
    //动画
    o.animate();
    //初始化机组
    getBoilerListAll().then(res => {
          o.boilers=getDateMore(res.data.data,-1,["syntime",]);
          if(o.boilerid==-1){
            console.log(0);
            o.boiler=o.boilers[0].k_Name_kw;
            o.boilerid=o.boilers[0].id;
            o.boilertime=o.boilers[0].syntime;
            o.boilerPositive=o.boilers[0].positive;
            o.boilerCounter=o.boilers[0].counter;

            // console.log(o.boilers[0]);
            this.Cw_High=o.boilers[0].cw_High;
            this.Cw_Low=o.boilers[0].cw_Low;
            this.Bw_dg=o.boilers[0].bw_dg;
            this.Bw_pg=o.boilers[0].bw_pg;
            this.Bw_gg=o.boilers[0].bw_gg;
          }else{
            o.boilers.map(x=>{
              if(x.id==o.boilerid){
                o.boilertime=x.syntime;
              }
            });
            
          }
          //初始化吹灰列表
          o.quenlist(o.boilerid);
        });
    //初始化吹灰列表
    // o.quenlist(o.boilerid);


    o.timer2=setInterval(() => {

      if(o.boilerid==-1){
        return;
      }
      o.quenlist(o.boilerid);
      // o.initpoint(o.boilerid);
    }, 5000);



    
    
    // if (document.hidden !== undefined) {
      // document.addEventListener('visibilitychange', () => {
      //   o.$router.go(0);
      // })
    // }
  },
  beforeDestroy() {
    clearInterval(this.timer2);
  }
};
</script>
<!--  加上私有化属性scoped后 threejs找不到，所以不能加 -->
<style>

.znch .labeles6 {
  color: #FFF;
  font-family: sans-serif;
  font-size: 16px;
  border: 1px solid #fff;
  padding-left: 3px;
  padding-right: 3px;
  padding-top: 3px;
  padding-bottom: 3px;

  background: rgba(21, 29, 9, 0.6);
}
.znch .ivu-tabs .ivu-tabs-content-animated {
  height: 100% !important;
}
</style>
